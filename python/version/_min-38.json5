/**
 * Version 3.8 as the minimum Python version for a project.
 **/
{
  rules: [
    {
      files: [".pre-commit-config.yaml"],
      ifJMESPathsMatch: {
        "pyproject.toml": [
          ["starts_with(project.\"requires-python\", '>=3.8')", true],
        ],
      },
      JMESPathsMatch: [
        [
          "contains(repos[?repo=='https://github.com/asottile/pyupgrade'] | [0].hooks[0].args, '--py38-plus')",
          true,
        ],
      ],
    },
    {
      files: ["pyproject.toml"],
      ifJMESPathsMatch: {
        "pyproject.toml": [
          ["starts_with(project.\"requires-python\", '>=3.8')", true],
        ],
      },
      JMESPathsMatch: [
        /**
         * isort
         **/
        ["tool.isort.py_version", 38],

        // https://docs.python.org/3/whatsnew/3.9.html#new-modules
        [
          "op(tool.isort.extra_standard_library, '>', ['zoneinfo', 'graphlib'])",
          true,
        ],
        // 3.10 does not add new modules
        // https://docs.python.org/3.11/whatsnew/3.11.html#new-modules
        [
          "op(tool.isort.extra_standard_library, '>', ['tomllib', 'wsgiref.types'])",
          true,
        ],
      ],
    },
    {
      files: ["pyproject.toml"],
      ifJMESPathsMatch: {
        // if pyproject.toml is specifying double quotes for flake8,
        // the formatting is black so we must specify the target version
        // in his configuration
        "pyproject.toml": [
          ['tool.flakeheaven."inline-quotes"', "double"],
          ["starts_with(project.\"requires-python\", '>=3.8')", true],
        ],
      },
      JMESPathsMatch: [
        ["type(tool.black)", "object"],
        ['type(tool.black."target-version")', "array"],
        ['length(tool.black."target-version")', 1],
        ['tool.black."target-version"[0]', "py38"],
      ],
    },
    {
      /**
       * project.classifiers
       **/
      files: ["pyproject.toml"],
      ifJMESPathsMatch: {
        "pyproject.toml": [
          ["starts_with(project.\"requires-python\", '>=3.8')", true],
        ],
      },
      JMESPathsMatch: [
        [
          "contains(project.classifiers, 'Programming Language :: Python :: 3.8')",
          true,
        ],
        [
          "contains(project.classifiers, 'Programming Language :: Python :: 3.7')",
          false,
        ],
      ],
    },
  ],
}
